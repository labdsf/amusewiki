#!/bin/sh

filelist=`mktemp`

{
find ./lib -type f -iname "*.pm" | grep -v debug_loc
find ./root/src -type f -iname "*.tt" | grep -v debug_loc
find ./mkits -type f
echo ./root/static/js/amw-batch-upload.js
} | sort -u | tee $filelist

xgettext.pl -P perl=* -P tt2=* -P generic=js \
    --output=lib/AmuseWikiFarm/I18N/messages.pot -f $filelist

for i in hr fi es mk ru id it de fr nl en sq sr sv pl pt da cs tr ar fa he; do
    msgmerge --no-fuzzy-matching --update --no-location \
             lib/AmuseWikiFarm/I18N/$i.po \
             lib/AmuseWikiFarm/I18N/messages.pot
done

